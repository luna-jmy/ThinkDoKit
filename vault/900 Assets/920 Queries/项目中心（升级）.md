---
cssclasses:
  - fullwidth
  - matrix
start_date: 2025-01-01
due_date: 2025-12-31
obsidianUIMode: preview
area:
---

| `button-projectFolder` | `button-mainProject` |
| ---------------------- | -------------------- |
## 项目一览
>*有主项目文件的默认显示主项目文件名。无主项目文件的显示文件夹名。最多预览5个项目笔记，可在代码的第2行参数 `maxNotesDisplay = 5` 里修改预览笔记数量。*

```dataviewjs
dv.view("900 Assets/960 Scripts/projectOverview", {
    maxNotes: 5,
    status: "hide",
    area: "include"
});
```

## 项目进度

```dataviewjs
const currentPage = dv.current();
const filterStart = currentPage.start_date;
const filterEnd = currentPage.due_date;

const pages = dv.pages('#project')
    .where(p => p.type === "project")
    .where(p => p.start_date && p.due_date)
    .where(p => {
        const projectStart = dv.date(p.start_date);
        const projectEnd = dv.date(p.due_date);
        const filterStartDate = dv.date(filterStart);
        const filterEndDate = dv.date(filterEnd);
        return projectStart <= filterEndDate && projectEnd >= filterStartDate;
    })
    .where(p => p.status !== "cancelled")
    .sort(p => p.due_date, 'asc');

let mermaidCode = "```mermaid\ngantt\n";
mermaidCode += "    title 项目进度甘特图\n";
mermaidCode += "    dateFormat YYYY-MM-DD\n";
mermaidCode += "    axisFormat %y-%m\n\n";

const groupedPages = {};
pages.forEach(page => {
    const objective = page.objective || "默认项目";
    if (!groupedPages[objective]) {
        groupedPages[objective] = [];
    }
    groupedPages[objective].push(page);
});

Object.keys(groupedPages).forEach(context => {
    if (Object.keys(groupedPages).length > 1) {
        mermaidCode += `    section ${context}\n`;
    }

    groupedPages[context].forEach(page => {
        const taskName = page.file.name.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, ''); 
        const startDate = dv.date(page.start_date).toFormat("yyyy-MM-dd");
        const dueDate = dv.date(page.due_date).toFormat("yyyy-MM-dd");

        let status = "";
        if (page.status === "completed") {
            status = "done, ";
        } else if (page.status === "active") {
            status = "active, ";
        }

        mermaidCode += `    ${page.file.name} :${status}${taskName}, ${startDate}, ${dueDate}\n`;
    });

    mermaidCode += "\n";
});

mermaidCode += "```";

dv.paragraph(mermaidCode);
```

## 快速修改项目信息
![[项目管理.base]]
